---
title: "TCP"
date: "2023-11-21 23:57:57"
categories:
  - TCP
---

### TCP

我想大家可能面试都遇到过，什么3次握手，四次招手，其实我真的对这个很烦。

可能这就是八股吧，我可能现在这些张口就来，但是我始终觉得差了点什么，于是我开始搞这方面。

### 不一样的 TCP

后端称呼网络编程？套接字编程？
我之前就业是个前端程序员，但是我的话。什么都搞，所以说称为全栈也不过分。
编程中的套接字就是用来连接该网络的工具。表示计算机之间的连接。
### 网络编程

网络编程要比我们想象的简单得多，物理连接的话，我们并不担心。
我们只需考虑如何编写数据传输软件。
接听套接字的创建过程。
- 调用 socket 函数（安装电话机）
问：接电话需要准备什么
答：当然是电话机
- 调用 bind 函数（分配电话号码） 分配 ip 地址 和端口号
问：请问你的电话号码是多少？
答：我的电话号码是123-345
- 调用 listen 函数 (连接电话线)转为可接收请求
问：已架设完电话机后只需连接电话线。
答：对，只需连接就能接听电话
- 调用 accept 函数（拿起话筒） 受理连接请求
问：电话铃响了，我该怎么办
答：接听
---
拨打套接字的创建过程。
**客户端的套件字比服务端的简单，因为客户端程序只有调用 socket 函数创建套接字 和 调用 connect 函数向服务器端发送连接请求**

### 面向连接的套接字
可靠的，按序传递的，基于字节的面向连接的数据传输方式
- 传输过程中数据不会消失
- 按序传递数据
- 传输的数据不存在数据边界（不管调用几次write函数传递，但接收数据的计算机仅通过一次read函数调用就接收了全部字节。）

### 面向消息的套接字
不可靠的，不按序传递的，以数据的高速传输为目的的套接字
- 强调快速传输而非传输顺序
- 传输的数据可能丢失也可能损毁
- 传输的数据有数据边界
- 限制每次传输的数据大小

可以想象成快递员，用车发送同一目的地多件包裹无u需保证顺序，只要速度。
这种方式有丢失的风险，而且包裹大小有一定限制。
若要传输大量数据，则需分批发送，如果2个快递员发送两个包裹，则接收者需要分两次接收。
（传输的数据有数据边界）

### 区分套接字的端口号

IP 用与区分计算机，只要有 ip地址，就能向目标主机发送数据。
但是我们在浏览器，or app 上看电影或者什么，这个数据是发送给谁呢？

**计算机一般配有 NIC （网络接口卡）** 通过 NIC 向计算机内部传输数据时会用到 IP，操作系统负责把传递到内部的数据适当分配给套接字，这时就要利用端口号。
**通过 NIC 接收的数据内有端口号，操作系统正是参考此端口号把数据传输给相应端口的套接字。**
**端口号就是在同一操作系统内区分为不同的套接字而设置的。因此无法将一个端口号分配给不同套接字。**
**虽然端口号不能重复，但TCP套件字和UDP套接字不会共用端口号，所以允许重复。

### TCP/ip 协议栈共分五层

面对 “基于互联网的有效数据传输” 的命题，并非通过一个庞大协议解决问题。而是化整为零，通过层次化方案--TCP/IP人协议栈解决。

----应用层
---TCP OR UDP
--IP
-链路层

## 链路层
链路层是物理链接领域标准化的结果，也是最基本的领域，
专门定义 LAN，WAN，MAN等网络标准。

## ip 层
准备好物理连接之后就要传输数据。首先就要考虑路径的选择，向目标传输数据需要经过哪条路径？解决此问题就是 IP 层，
该层使用的协议就是 IP。

**IP 本身是面向消息的，不可靠的协议。每次传输数据时会帮我们选择路径,如果传输中发生路径错误，则选择路径，但如果发生数据丢失或错误，则无法解决。**

## TCP/UDP层
IP 层解决数据传输中的路径选择问题，只需照ci路径传输数据即可。
TCP和UDP以为IP提供的路径信息为基础完成实际的数据传输，故该层又称传输层。

ip 层只关注一个数据包，即使传输多个数据包，每个数据包也是由 IP 层实际传输的，也就是说传输顺序及传输本身是不可靠的。

**总之 TCP 和 UDP 存在与 IP 层上，决定主机之间的数据传输方式，TCP 协议确认后向不可靠的 IP 协议赋予可靠性**

**程序员编程时无需考虑这些过程，但这并不意味着不用掌握这些知识。**
**只有掌握了这些理论，才能编写出符合需求的网络程序。**

## 待续
